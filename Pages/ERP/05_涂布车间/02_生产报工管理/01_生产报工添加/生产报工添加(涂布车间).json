{"Rows":{"Sizes":{"3":25.0,"5":25.0,"7":25.0,"10":25.0,"14":25.0,"16":25.0,"18":25.0,"20":25.0,"22":25.0,"24":25.0,"26":25.0,"28":25.0},"InLogicalVisibleIndexes":[13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"Count":29},"Cols":{"InLogicalVisibleIndexes":[20,21,22,23,24,25,26,27,28],"Count":29},"Values":{"3,5":"货品名称：","3,24":"生产产线","5,5":"批号：","5,24":"产线自增编号","7,5":"规格：","7,10":"MM","7,16":"M","7,24":"日期","9,24":"日期文本","10,8":"确定","14,5":"生产ID：","16,5":"生产订单编号：","18,5":"已完成数量：","18,24":"剩余数量","20,5":"物料ID：","22,5":"物料编号：","24,5":"型号：","26,5":"单位：","28,5":"报工人："},"Formulas":{"18,6":"ODATA(\"加工生产订单表?$select=已完成数量&$filter=ID eq \"&IF(ISBLANK(G15),\"null\",G15))","7,20":"TODAY()","9,20":"TEXT(U8,\"YYYYMMDD\")","5,6":"U10&U4&U6","5,20":"ODATA(\"涂布报工批号表?$select=自增编号&$filter=生产产线 eq \"&IF(ISBLANK(U4),\"null\",\"'\"&U4&\"'\"))+1","18,20":"ODATA(\"加工生产订单表?$select=剩余生产数&$filter=ID eq \"&IF(ISBLANK(G15),\"null\",G15))"},"AttachInfos":{"3,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"物料名称"}},"5,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"生产批号"}},"7,6":{"CellType":{"$type":"Forguncy.TextCellType, ServerDesignerCommon","SavedValidators":[{"$type":"Forguncy.CellTypes.Models.UniqueValidadator, ServerDesignerCommon"}],"TemplateKey":"_RS_LightLine_Translucent_SmallRoundCorner_Normal1"},"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"宽"}},"7,12":{"CellType":{"$type":"Forguncy.TextCellType, ServerDesignerCommon","SavedValidators":[{"$type":"Forguncy.CellTypes.Models.UniqueValidadator, ServerDesignerCommon"}],"TemplateKey":"_RS_LightLine_Translucent_SmallRoundCorner_Normal1"},"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"长"}},"10,8":{"CellType":{"$type":"Forguncy.ButtonCellType, ServerDesignerCommon","CommandList":[{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionPageElementParam, ServerDesignerCommon","cellLocations":[{"SerializeProperty":"='生产报工添加(涂布车间)'!U4"}]},"Id":"1be93630-c1c3-4907-9bd1-7c10e7a83976"},"CommandList":[{"$type":"Forguncy.Model.ShowMessageCommand, ServerDesignerCommon","MessageFormula":"无效批号，报工失败！"},{"$type":"Forguncy.Model.ClosePopupCommand, ServerDesignerCommon"}],"ID":"0ff90e97-4fb6-4f5c-9992-ddba0c536d8d"},{"CommandList":[{"$type":"Forguncy.Model.ConditionCommand, ServerDesignerCommon","ConditionAndCommandPairList":[{"Condition":{"$type":"Forguncy.Model.IfCondition, ServerDesignerCommon","param":{"$type":"Forguncy.Model.IfConditionPageElementParam, ServerDesignerCommon","cellLocations":[{"SerializeProperty":"='生产报工添加(涂布车间)'!U19"}]},"value":"0","compareType":2,"Id":"987f84b2-fc0e-479f-b762-bbb30cef2dc7"},"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"加工生产订单表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"加工生产订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!G15"},"Id":"657d8d9a-bf1f-4216-afa8-da9fdfbb3b39"},"UpdateValues":[{"ColumnName":"已完成数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!G19+1"}}],"NextUpdateDataTableCommand":{"TableName":"加工生产报工表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"报工类型","Value":"涂布半成品"},{"ColumnName":"数量","Value":"1"}],"NextUpdateDataTableCommand":{"TableName":"涂布报工批号表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"涂布报工批号表","ColumnName":"生产产线"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!U4"},"Id":"1d072b10-27c1-4a5a-a269-b64e090e33c5"},"UpdateValues":[{"ColumnName":"自增编号","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!U6"}}]}},"ParamNameToSaveNewRowValue":"NewRow"},{"$type":"Forguncy.Model.ShowMessageCommand, ServerDesignerCommon","MessageFormula":"报工成功！"},{"$type":"Forguncy.Model.NavigateCommand, ServerDesignerCommon","PageName":"生产报工记录(涂布车间).html","PassValues":[],"DeleteCachedQuery":true}],"ID":"b1dfa9db-9736-4089-b625-4e0bac30dd0d"},{"CommandList":[{"$type":"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon","TableName":"加工生产订单表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"加工生产订单表","ColumnName":"ID"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!G15"},"Id":"31ec0616-adf6-4627-bbe4-82559f791e3c"},"UpdateValues":[{"ColumnName":"已完成数量","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!G19+1"}},{"ColumnName":"上工状态","Value":"已完工"}],"NextUpdateDataTableCommand":{"TableName":"加工生产报工表","UpdateType":"add","ShowConfirm":false,"ConfirmText":"您确定添加这条记录?","UpdateValues":[{"ColumnName":"报工类型","Value":"涂布半成品"},{"ColumnName":"数量","Value":"1"}],"NextUpdateDataTableCommand":{"TableName":"涂布报工批号表","ShowConfirm":false,"ConfirmText":"您确定要更新这行记录吗？","RowsToUpdate":1,"RowsToUpdateCondition":{"$type":"ForguncyDataAccess.GeneralCESqlCondition, ForguncyDataAccess","ColumnBindingInfo":{"TableName":"涂布报工批号表","ColumnName":"生产产线"},"Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!U4"},"Id":"a2441253-8bb0-42d3-8ad6-2f75fdb0e1af"},"UpdateValues":[{"ColumnName":"自增编号","Value":{"$type":"Forguncy.Model.FormulaReferObject, ServerDesignerCommon","SerializeProperty":"='生产报工添加(涂布车间)'!U6"}}]}},"ParamNameToSaveNewRowValue":"NewRow"},{"$type":"Forguncy.Model.ShowMessageCommand, ServerDesignerCommon","MessageFormula":"报工成功！"},{"$type":"Forguncy.Model.NavigateCommand, ServerDesignerCommon","PageName":"生产报工记录(涂布车间).html","PassValues":[],"DeleteCachedQuery":true}],"ID":"a6097f63-e325-45ad-b389-9fbe52e639ee"}]}],"ID":"75d52c4c-83b9-406f-a4a9-13937d6996c3"}]}],"Text":"确定","TemplateKey":"_RS_Outline_Style2"}},"14,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"加工生产订单表ID"}},"16,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"生产订单号"}},"20,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"物料ID"}},"22,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"物料编号"}},"24,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"型号"}},"26,6":{"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"单位"}},"28,6":{"CellType":{"$type":"Forguncy.CurrentUserCellType, ServerDesignerCommon","CellCustomValue":"%CurrentUser%","ShowUserPicture":false,"ShowDropDown":false,"ShowNotification":false},"BindingInfo":{"TableName":"加工生产报工表","ColumnName":"报工人"}}},"StyleDatas":{"Styles":[{"HorizontalAlignment":0},{"BorderBottom":0},{"Background":2},{"Background":3},{"Formatter":4,"HorizontalAlignment":5,"BorderBottom":0},{"HorizontalAlignment":6},{"Background":3,"FontFamily":7,"Formatter":8},{"FontFamily":7},{"FontFamily":7,"Formatter":9},{"Background":10,"FontFamily":7},{"Background":11},{"FontFamily":7,"HorizontalAlignment":0}],"Types":{"Strs":["Right","Text 1 50","Accent 6 0","Accent 5 0","@","Center","Left","Body","yyyymmdd","[AUTO]General","Accent 4 0","Accent 3 0"],"Borders":[{"Color":1}]},"CellStyles":{"3,5":0,"3,6":1,"3,7":1,"3,8":1,"3,9":1,"3,10":1,"3,11":1,"3,12":1,"3,13":1,"3,14":1,"3,15":1,"3,20":2,"5,5":0,"5,6":1,"5,7":1,"5,8":1,"5,9":1,"5,10":1,"5,11":1,"5,12":1,"5,13":1,"5,14":1,"5,15":1,"5,20":3,"7,5":0,"7,6":4,"7,7":1,"7,8":1,"7,9":1,"7,10":5,"7,12":4,"7,13":1,"7,14":1,"7,15":1,"7,16":5,"7,20":6,"7,21":7,"7,22":7,"7,23":7,"7,24":8,"7,25":7,"7,26":7,"7,28":7,"8,20":7,"8,21":7,"8,22":7,"8,23":7,"8,24":7,"8,25":7,"8,26":7,"8,27":7,"8,28":7,"9,20":9,"9,21":7,"9,22":7,"9,23":7,"9,24":7,"9,25":7,"9,26":7,"9,28":7,"14,5":0,"15,5":0,"16,5":0,"17,20":7,"17,21":7,"17,22":7,"17,23":7,"17,24":7,"17,25":7,"17,26":7,"17,27":7,"17,28":7,"18,5":0,"18,20":10,"20,5":0,"22,5":0,"24,5":0,"26,5":11,"26,6":7,"26,7":7,"26,8":7,"26,9":7,"26,10":7,"26,11":7,"26,12":7,"26,13":7,"26,14":7,"26,15":7,"28,5":0},"SheetStyle":{"FontFamily":7}},"Spans":["14,6,1,10","16,6,1,10","20,6,1,10","22,6,1,10","3,6,1,10","24,6,1,10","10,8,1,3","26,6,1,10","28,6,1,10","18,6,1,10","7,12,1,4","7,6,1,4","3,20,1,4","3,24,1,5","5,20,1,4","5,24,1,5","7,20,1,4","7,24,1,5","9,20,1,4","9,24,1,5","18,24,1,5","18,20,1,4","5,6,1,10"],"PageInfo":{"$type":"Forguncy.Model.Pages.NormalPage, ServerDesignerCommon","AuthorizeInfo":{"VisitMode":6,"AllowVisitedRoles":["Administrator","计划","总经理","生产主管","管理","涂布"]},"RowBreakLines":[],"RepeatRangeSettings":[]},"PrintInfo":{"Margin":{},"PaperSize":{}}}